(()=>{var e={108:()=>{var e=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(t)?(n.classList.remove(e.inactiveButtonClass),n.removeAttribute("disabled")):(n.classList.add(e.inactiveButtonClass),n.setAttribute("disabled","disabled"))};function t(t){var n=document.querySelector(t.formSelector);n.addEventListener("submit",(function(e){e.preventDefault()})),function(t,n){var r=Array.from(n.querySelectorAll(t.inputSelector)),o=n.querySelector(t.submitButtonSelector);e(t,r,o),r.forEach((function(n){n.addEventListener("input",(function(){(function(e,t){t.validity.valid?function(e,t){var n=document.getElementById("".concat(t.id,"-error"));t.classList.remove(e.inputErrorClass),n.classList.remove(e.errorClass),n.textContent=""}(e,t):function(e,t,n){var r=document.getElementById("".concat(t.id,"-error"));t.classList.add(e.inputErrorClass),r.textContent=n,r.classList.add(e.errorClass)}(e,t,t.validationMessage)})(t,n),e(t,r,o)}))}))}(t,n)}t({formSelector:".form",inputSelector:".form__item",submitButtonSelector:".form__button-save",inactiveButtonClass:"form__button-save_inactive",inputErrorClass:"form__item_type_error",errorClass:"form__input-error_active"}),t({formSelector:".form_plus",inputSelector:".form__item",submitButtonSelector:".form__button-save",inactiveButtonClass:"form__button-save_inactive",inputErrorClass:"form__item_type_error",errorClass:"form__input-error_active"}),t({formSelector:".form_update-avatar",inputSelector:".form__item",submitButtonSelector:".form__button-save",inactiveButtonClass:"form__button-save_inactive",inputErrorClass:"form__item_type_error",errorClass:"form__input-error_active"})}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.d(r,{x:()=>U});var e={};function t(e){"Escape"==e.key&&S(document.querySelector(".shadow_show"))}n.r(e),n.d(e,{V:()=>k});var o=document.querySelector(".profile__button-redaction"),a=document.querySelector(".profile__title"),c=document.querySelector(".profile__subtitle"),i=document.querySelector(".form"),s=i.querySelector("#textName"),u=i.querySelector("#textDescription"),l=document.querySelector(".popup__text"),d=document.querySelector(".shadow"),f=document.querySelector(".popup__view-image"),m=document.querySelector(".popup__add-card"),v=document.querySelector(".popup__edit-avatar"),_=m.querySelector("#textTitle"),h=m.querySelector("#textLink"),y=document.querySelector(".profile__image"),p=document.querySelector(".profile__button-redaction-image");function b(e){e.classList.add("shadow_show"),document.addEventListener("keydown",t)}function S(e){e.classList.remove("shadow_show"),document.removeEventListener("keydown",t)}document.querySelectorAll(".shadow").forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("shadow_show")&&S(e),t.target.classList.contains("modal-window__buttons-exit")&&S(e)}))}));var g=document.querySelector(".profile__button-plus");function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var k=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseUrl=t.baseUrl,this.headers=t.headers}var t,n;return t=e,(n=[{key:"checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))}},{key:"loadUserData",value:function(){return fetch("".concat(this.baseUrl,"/users/me"),{method:"GET",headers:this.headers})}},{key:"loadCards",value:function(){return fetch("".concat(this.baseUrl,"/cards"),{method:"GET",headers:this.headers})}},{key:"saveEditProfile",value:function(e,t){return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:t})})}},{key:"saveNewCard",value:function(e,t){return fetch("".concat(this.baseUrl,"/cards"),{method:"POST",headers:this.headers,body:JSON.stringify({name:e,link:t})})}},{key:"deleteCard",value:function(e){return fetch("".concat(this.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this.headers,body:JSON.stringify({id:e})})}},{key:"likeCard",value:function(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this.headers,body:JSON.stringify({id:e})})}},{key:"deleteLikeCard",value:function(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this.headers,body:JSON.stringify({id:e})})}},{key:"saveEditAvatar",value:function(e){return fetch("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})})}}])&&C(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),E=document.querySelector(".elements"),q=document.querySelector("#card-template").content.querySelector(".card"),L=document.querySelector(".form_deletion-confirmation"),x=document.querySelector(".popup__image"),w=document.querySelector(".popup__deletion-confirmation"),A=function(t,n){var r=function(t){var n=q.cloneNode(!0),r=n.querySelector(".card__image"),o=n.querySelector(".card__text"),a=n.querySelector(".card__count");r.src=t.link,o.textContent=t.name,a.textContent=t.likes.length,n.id=t._id,r.setAttribute("alt",t.name),r.addEventListener("click",(function(){return e=t.link,n=t.name,x.src=e,x.alt=n,b(f),void(l.textContent=n);var e,n}));var c=n.querySelector(".card__button");t.likes.forEach((function(e){e._id==U&&c.classList.add("card__button_active")})),c.addEventListener("click",(function(){c.classList.contains("card__button_active")?(0,e.deleteLikeCard)(t._id).then(e.checkResponse).then((function(e){c.classList.toggle("card__button_active"),a.textContent=e.likes.length})).catch((function(e){console.log(e)})):(0,e.likeCard)(t._id).then(e.checkResponse).then((function(e){c.classList.toggle("card__button_active"),a.textContent=e.likes.length})).catch((function(e){console.log(e)}))}));var i=n.querySelector(".card__basket");return i.addEventListener("click",(function(e){b(w),L.cardId=e.target.parentElement.id})),t.owner._id==U&&i.classList.add("card__basket_visible"),n}(t);n.prepend(r)},O=m.querySelector(".form_plus");function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}O.addEventListener("submit",(function(t){t.preventDefault();var n=O.querySelector(".form__button-save");n.textContent="Сохранение...",(0,e.saveNewCard)(_.value,h.value).then(e.checkResponse).then((function(e){A(e,E),S(m)})).catch((function(e){console.log(e)})).finally((function(){n.textContent="Создать"}))})),n(108),document.querySelector(".preload").classList.remove("preload");var U="";document.addEventListener("keydown",(function(e){t(e)})),i.addEventListener("submit",(function(t){t.preventDefault();var n=i.querySelector(".form__button-save");n.textContent="Сохранение...",(0,e.saveEditProfile)(s.value,u.value).then(e.checkResponse).then((function(e){a.textContent=e.name,c.textContent=e.about,S(d)})).catch((function(e){console.log(e)})).finally((function(){n.textContent="Сохранить"}))})),y.addEventListener("mouseover",(function(){p.style.display="block"})),p.addEventListener("mouseout",(function(){p.style.display="none"})),p.addEventListener("click",(function(){b(v)})),o.addEventListener("click",(function(){b(d),s.value=a.textContent,u.value=c.textContent}));var T=m.querySelector(".form__button-save");g.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),b(m),O.reset(),T.setAttribute("disabled","disabled"),T.classList.add("form__button-save_inactive")})),L.addEventListener("submit",(function(t){t.preventDefault();var n=L.querySelector(".form__button-save_deletion-confirmation");n.textContent="Сохранение...",(0,e.deleteCard)(t.target.cardId).then(e.checkResponse).then((function(){S(w),document.getElementById(t.target.cardId).remove()})).catch((function(e){console.log(e)})).finally((function(){n.textContent="Да"}))}));var B=document.querySelector(".form_update-avatar");B.addEventListener("submit",(function(){var t=document.getElementById("linkImage").value,n=B.querySelector(".form__button-save");n.textContent="Сохранение...",(0,e.saveEditAvatar)(t).then(e.checkResponse).then((function(e){y.setAttribute("src",e.avatar),S(v)})).catch((function(e){console.log(e)})).finally((function(){n.textContent="Сохранить"}))})),Promise.all([(0,e.loadUserData)(),(0,e.loadCards)()]).then((function(t){var n,r,o=(r=2,function(e){if(Array.isArray(e))return e}(n=t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);c=!0);}catch(e){i=!0,o=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw o}}return a}}(n,r)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],s=o[1];(0,e.checkResponse)(i).then((function(e){a.textContent=e.name,c.textContent=e.about,y.setAttribute("src",e.avatar),c.textContent=e.about,U=e._id})).catch((function(e){console.log(e)})),(0,e.checkResponse)(s).then((function(e){e.reverse().forEach((function(e){A(e,E)}))})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)})),new k({baseUrl:"https://mesto.nomoreparties.co/v1/plus-cohort-13",headers:{authorization:"15612dfc-e819-4f89-bf79-39ea6734df41","Content-Type":"application/json"}})})()})();